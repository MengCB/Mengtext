<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>前端模块化</title>
		<style type="text/css">
			.mainContent{
				width: 100%;
				min-height: 40px;
				border: 1px solid peachpuff;
			}
			
			#mother{
				position: absolute;
				left: 50%;
				min-height: 40px;
				width: 500px;
				margin-left: -250px;
				border: 1px solid brown;
				margin-top: 50px;
			}
		</style>
		
	</head>
	<body>
		
		<div class="mainContent" id="father">
			
		</div>
		<div id="mother"></div>
	</body>
</html>
<script type="text/javascript">
	// 将函数作为模块的弊端--污染了全局变量
	//zhao
	function changePassword() {
		console.info("我是zhao")
	};

	// li
	function changePassword() {
		console.info("我是li")
	};

	// 改进方法 - (其实也没用) - 写到对象里 - 会暴露属性
	var module1 = new Object({
		ariginaPassword: 0, // 原始密码
		zhao: function() {
			console.info("我是zhao" + this.ariginaPassword);
		},
		li: function() {
			console.info("我是li" + this.ariginaPassword);
		},
	});

	// 继续改进的方法 - 使用自调用/立即执行函数(可以达到不暴露私有成员的目的。)
	// 自己能调用自己的属性外部却不能调用
	// 这就是模块
	var module2 = (function() {
		var ariginaPassword = 0;
		var zhao = function() {
			console.info("我是zhao" + ariginaPassword);
		};

		var li = function() {
			console.info("我是li" + ariginaPassword);
		};

		// 返回对象是必须的
		return {
			zhao: zhao,
			li: li
		};
	})();

	// 放大模式 - 可扩展 -- 告诉你可行性
	module2 = (function(mod) {
		mod.su = function() {
			console.info("我是su--");
		};

		return mod;

	})(module2);
	
	//宽放大模式 (容错，允许m3不存在，则传入一个空对象作为参数)
	// 也可以有多个依赖模块
	//  module3 = ( function (mod , jq2){
	// 　　　　//...
	// 　　　　return mod;
	// 　　})(window.module3 || {} , jQuery);
	
	
	
	// 课堂练习: -编写一个组件,在mainContent内生成随机颜色的圆圈 
	// 注意: 圆圈用模块化方法来写
	var Boll = (function(){
		var bollCount = 0;
		var bollCountMax = 5;
		var timer1 = 0;
		var _fatherId = "";
		
		// 模块初始化,在页面上新增一个style标签
		var init = function( fatherId ){
			if(!fatherId){
				console.info("没给爹！");
				return;
			}
			document.head.innerHTML += '<style type="text/css">.boll{float: left;margin-left:12px;'+
			                            'width: 40px;height: 40px;background: lightblue;'+
									   'border-radius: 50%;}</style>';
            _fatherId = fatherId || "father";
			
			creatBollsInTime();
		}
		
		// 生成一个球
		var creatNewBoll = function( father ){
			document.getElementById(father).innerHTML += '<div class="boll"></div>'
		    bollCount++;
			if( bollCount > bollCountMax ){
				clearAll();
			}
		}
		
		var creatBollsInTime = function(){
			timer1 = setInterval(function(){
				creatNewBoll(_fatherId);
			},1000)
		}
		
		var clearAll = function(){
			var bollsCount = document.getElementsByClassName("boll");
			while( bollsCount.length > 0 ){
				bollsCount[0].remove();
			}
			bollCount = 0;
		}
		
		// 销毁
		var detroy = function(){
			clearInterval(timer1);
			clearAll();
		}
		
		return {
			init: init,
			detroy: detroy
		}
	})();
	
</script>
